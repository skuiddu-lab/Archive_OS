/* --- 1. CORE VARIABLES & RESET --- */
:root {
    --bg-color: #050505;
    --panel-bg: #0f0f12;
    --accent-primary: #00ffcc;    /* Data Cyan */
    --accent-secondary: #ff0055;  /* Error Red */
    --accent-gold: #ffcc00;       /* Complete Gold */
    --text-main: #e0e0e0;
    --text-muted: #667788;
    --font-header: 'Rajdhani', sans-serif;
    --font-mono: 'JetBrains Mono', monospace;
}

* { box-sizing: border-box; }

body, html {
    height: 100vh; margin: 0; padding: 0; overflow: hidden;
    background-color: var(--bg-color); color: var(--text-main);
    font-family: var(--font-header);
}

/* --- 2. UTILITY & ANIMATIONS --- */
.hidden { display: none !important; }
.blink { animation: blinker 1.5s linear infinite; color: var(--accent-secondary); }
@keyframes blinker { 50% { opacity: 0; } }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes flashText { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

/* SCANLINES */
.scanlines {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    background-size: 100% 2px, 3px 100%;
    pointer-events: none; z-index: 999; opacity: 0.5;
}

/* --- 3. HEADER & LAYOUT --- */
header {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    padding: 0 20px 0 20px;
    background: #000;
    border-bottom: 2px solid var(--accent-primary);
    box-shadow: 0 0 15px rgba(0, 255, 204, 0.1);
    height: 70px; z-index: 1000;
}

h1 { margin: 0; color: var(--accent-primary); text-transform: uppercase; justify-self: start; }
nav { display: flex; gap: 10px; justify-self: center; }
.stats { font-family: var(--font-mono); color: var(--accent-gold); justify-self: end; border: 1px solid #333; padding: 5px 15px; }

main { height: calc(100vh - 70px); width: 100vw; position: relative; overflow: hidden; }

/* --- 4. BUTTONS --- */
button {
    font-family: var(--font-header); text-transform: uppercase; cursor: pointer;
    background: #000; color: #fff; border: 1px solid #333;
    padding: 8px 15px; border-radius: 2px; transition: all 0.2s;
}
button:hover { border-color: var(--accent-primary); color: var(--accent-primary); }

.reset-btn { background: #500; border: none; font-size: 10px; margin-left: 10px; }
.reset-btn:hover { background: #f00; }

/* --- 5. SUMMON / SCANNER ROOM --- */
#view-summon {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 100%; width: 100%;
}
.summon-controls { display: flex; gap: 20px; margin-top: 20px; }
.summon-btn {
    padding: 20px 40px; font-size: 1.2em; min-width: 200px;
    border: 2px solid var(--accent-primary); color: var(--accent-primary);
}
.summon-btn:hover { background: var(--accent-primary); color: #000; box-shadow: 0 0 20px var(--accent-primary); }
.summon-btn.multi { border-color: var(--accent-gold); color: var(--accent-gold); }
.summon-btn.multi:hover { background: var(--accent-gold); }

/* RISULTATI (Card & Grid) */
#summon-result {
    margin-top: 30px; background: rgba(0,0,0,0.9); border: 1px solid #444;
    padding: 20px; animation: fadeIn 0.5s;
}

/* Griglia x10 */
#summon-result.summon-grid {
    display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;
    width: 95%; max-width: 1200px; max-height: 40vh; overflow-y: auto;
}

/* CARD STILE */
.summon-card {
    background: linear-gradient(135deg, #0a0a0a 0%, #151515 100%);
    border: 1px solid #444;
    padding: 15px;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: transform 0.2s, box-shadow 0.2s;
    display: flex;            /* Assicura che il contenuto si centri */
    flex-direction: column;   /* Impila gli elementi verticalmente */
    justify-content: center;  /* Centra verticalmente */
    align-items: center;      /* Centra orizzontalmente */
}
.summon-card h2 {
    width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0 5px; /* Un po' di respiro laterale */
    font-size: 1.1em; /* Dimensione fissa */
}
/* EFFETTO INTEGRITY / VIRTUALIZZAZIONE */
.integrity-low {
    opacity: 0.8;
    border-style: dashed;
    filter: grayscale(0.8); /* Colori spenti perché parziale */
}
.integrity-low h2 { text-shadow: 2px 0 var(--accent-secondary); } /* Glitch text */

.integrity-full {
    border: 2px solid var(--accent-gold);
    box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
    filter: none;
}

.summon-card.mini {
    min-height: 0 !important; /* Rimuove la vecchia regola */
    height: 100% !important;  /* Si adatta all'altezza della cella della griglia */
    padding: 10px !important;
}
@keyframes cyber-materialize {
    0% { opacity: 0; transform: scale(0.8); filter: blur(5px); }
    100% { opacity: 1; transform: scale(1); filter: blur(0); }
}

/* --- 6. MANAGEMENT ROOM --- */
/* Questo container occupa tutto lo spazio rimanente */
#view-manage {
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
}

.management-container {
    display: flex; 
    flex-grow: 1;          /* Occupa tutto lo spazio verticale disponibile */
    height: 100%;          /* Forza altezza massima */
    gap: 15px; 
    padding: 10px; 
    padding-bottom: 50px;  /* Spazio per la console in basso */
    overflow: hidden;      /* Evita scroll doppi */
}

.sidebar { 
    width: 320px; 
    border-right: 1px solid #333; 
    overflow-y: auto; 
    background: var(--panel-bg); 
    display: flex;         /* Flex per gestire il contenuto */
    flex-direction: column;
    height: 100%;          /* Altezza piena */
}

.main-panel { 
    flex-grow: 1; 
    padding: 20px; 
    overflow-y: auto; 
    background: var(--panel-bg); 
    border: 1px solid #222; 
    height: 100%;          /* Altezza piena */
    position: relative;    /* Per posizionare elementi interni */
}

/* Stile per la lista unità */
.unit-list-btn {
    display: flex; justify-content: space-between; padding: 12px;
    background: transparent; border-bottom: 1px solid #222; margin: 0;
    width: 100%; text-align: left; /* Fix allineamento */
}
.unit-list-btn.active { background: #1a1a1a; border-left: 4px solid var(--accent-primary); }

/* Sezione vuota sidebar (se serve riempire) */
.sidebar h3 {
    padding: 10px; margin: 0; background: #000; border-bottom: 1px solid var(--accent-primary);
    position: sticky; top: 0;
}
/* --- STILE MANCANTE PER LE TASK --- */
.action-grid { 
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); 
    gap: 15px; 
}

.action-card { 
    background: #080808; 
    border: 1px solid #333; 
    padding: 15px; 
    cursor: pointer;
    transition: all 0.2s;
}

.action-card:hover { 
    border-color: var(--accent-primary); 
    background: #111; 
}
/* --- 7. SYNC & BARS --- */
.progress-bar-bg { background: #222; height: 8px; margin-top: 10px; border-radius: 2px; }
.progress-bar-fill { height: 100%; background: var(--accent-primary); width: 0%; transition: width 0.1s linear; }
.progress-bar-fill.recovering { background: #00ff41; }

.sync-container { display: flex; align-items: center; margin-top: 10px; padding: 5px; background: #000; border: 1px solid #333; }
.sync-heart { color: #444; margin-right: 5px; }
.sync-heart.synced { color: #ff00ff; animation: heartBeat 1.5s infinite; }

/* --- 8. CONSOLE LOG --- */
#console-container {
    position: fixed; bottom: 0; left: 0; width: 100%; z-index: 2000;
    background: #000; border-top: 1px solid #333; transition: transform 0.3s;
}
#console-header { height: 30px; display: flex; align-items: center; padding: 0 10px; background: #111; color: var(--accent-primary); cursor: pointer; }
#console-log { height: 120px; overflow-y: auto; padding: 10px; font-family: var(--font-mono); font-size: 12px; color: #888; }
#console-container.collapsed { transform: translateY(120px); }
.log-entry { margin-bottom: 2px; border-bottom: 1px dashed #222; }

/* --- 9. RESPONSIVE --- */
@media (max-width: 800px) {
    header { display: flex; justify-content: space-between; padding: 0 10px; }
    h1 { font-size: 18px; }
    .management-container { flex-direction: column; }
    .sidebar { width: 100%; height: 40%; }
    #summon-result.summon-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
}

/* --- BANNER SYSTEM --- */
/* --- CAROUSEL STYLES --- */
.carousel-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
    width: 100%;
    max-width: 900px; /* Più largo per dare spazio */
}

.nav-arrow {
    background: transparent;
    border: 2px solid #333;
    color: var(--accent-primary);
    font-size: 2em;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.2s;
}

.nav-arrow:hover {
    background: rgba(0, 255, 204, 0.1);
    border-color: var(--accent-primary);
    box-shadow: 0 0 15px rgba(0, 255, 204, 0.2);
    transform: scale(1.1);
}

/* BIG FEATURED BANNER */
.featured-banner {
    flex-grow: 1;
    background: linear-gradient(135deg, #111 0%, #050505 100%);
    border: 2px solid #444;
    padding: 30px;
    height: 300px; /* Altezza fissa per evitare salti */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    position: relative;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    transition: all 0.3s ease;
    border-radius: 4px;
}

.featured-banner h2 {
    font-size: 2.5em;
    margin: 0 0 10px 0;
    text-transform: uppercase;
    letter-spacing: 2px;
}

.featured-banner p {
    color: #888;
    font-family: var(--font-mono);
    font-size: 1.1em;
    max-width: 90%;
}

/* Etichetta "Source" in alto a destra */
.featured-banner .banner-source {
    position: absolute;
    top: 15px; right: 15px;
    background: rgba(0,0,0,0.6);
    padding: 5px 10px;
    font-size: 0.8em;
    color: #fff;
    border: 1px solid #444;
    font-family: var(--font-mono);
}

.summon-actions-panel {
    margin-top: 30px;
    width: 100%;
    display: flex;
    justify-content: center;
}
/* SUMMON BUTTONS PANEL */
.summon-actions-panel {
    margin-top: 30px;
    width: 100%;
    display: flex;
    justify-content: center;
}
/* --- TABS NEI DETTAGLI --- */
.details-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    border-bottom: 1px solid #333;
}

.tab-btn {
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    color: #666;
    padding: 10px 20px;
    font-size: 0.9em;
    width: auto; /* Sovrascrive larghezza bottone standard */
}

.tab-btn.active {
    color: var(--accent-primary);
    border-bottom-color: var(--accent-primary);
    background: rgba(0, 255, 204, 0.05);
}

/* --- PANNELLO ARCHIVE INFO --- */
.info-panel {
    animation: fadeIn 0.3s;
}

.lore-box {
    background: #080808;
    border-left: 3px solid var(--accent-gold);
    padding: 15px;
    font-style: italic;
    color: #aaa;
    margin-bottom: 20px;
    font-family: var(--font-mono);
    font-size: 0.85em;
    line-height: 1.4;
}

.data-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 20px;
}

.data-box {
    border: 1px solid #333;
    padding: 10px;
}
.data-box h4 { margin: 0 0 5px 0; color: #666; font-size: 0.7em; }
.data-box .value { font-size: 1.1em; color: #fff; }

.future-events li {
    margin-bottom: 5px;
    color: #666;
    font-size: 0.8em;
    list-style: none;
}
.future-events li.unlocked { color: var(--accent-gold); }

/* --- COMPATTARE LE CARD NELLA MULTI-SUMMON (.mini) --- */

/* Riduciamo drasticamente lo spazio interno */
.summon-card.mini {
    padding: 8px 5px !important; /* Molto meno padding verticale */
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-height: 140px; /* Altezza minima fissa per uniformità */
}

/* Icona più piccola e vicina al titolo */
.summon-card.mini .icon-type {
    font-size: 1.5em !important;
    margin-bottom: 2px !important;
    line-height: 1;
}

/* Titolo più compatto */
.summon-card.mini h2 {
    font-size: 1em !important;
    margin: 2px 0 5px 0 !important;
    line-height: 1.2;
    
    /* Se il nome è lungo, evita che vada a capo troppo spesso */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Testi secondari (Classe, Integrità, ecc.) molto più piccoli */
.summon-card.mini div {
    font-size: 0.75em !important;
    margin-top: 2px !important;
    line-height: 1.2;
}

/* Rimpiccioliamo anche le stelline */
.summon-card.mini .icon-type[style*="gold"] {
    font-size: 1em !important; /* Stelline più piccole */
    letter-spacing: -2px; /* Avvicinale tra loro */
}

/* --- USER PROFILE PANEL (Slide-in) --- */
.side-panel {
    position: fixed; top: 0; right: -400px; /* Nascosto a destra */
    width: 350px; height: 100vh;
    background: rgba(10, 10, 12, 0.95);
    border-left: 2px solid var(--accent-primary);
    box-shadow: -10px 0 30px rgba(0,0,0,0.8);
    transition: right 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
    z-index: 2000; display: flex; flex-direction: column;
    backdrop-filter: blur(5px);
}
.side-panel.open { right: 0; }

.panel-header {
    padding: 20px; border-bottom: 1px solid #333;
    display: flex; justify-content: space-between; align-items: center;
    background: #000;
}
.panel-header h2 { margin: 0; color: var(--accent-primary); }
.close-btn { background: transparent; border: none; font-size: 1.5em; color: #fff; }

.panel-content { padding: 20px; font-family: var(--font-mono); }
.stat-row { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px dashed #333; padding-bottom: 5px; }

/* --- NEURAL LINK (TRAINING) VIEW --- */
.training-container { 
    display: flex; 
    flex-grow: 1; /* Occupa tutto lo spazio come management */
    height: 100%; 
    gap: 15px; /* Gap ridotto a 15px come management */
    padding: 10px; /* Padding ridotto a 10px */
    padding-bottom: 50px;
    overflow: hidden;
}
.training-sidebar { 
    width: 320px; /* Larghezza allineata a 320px */
    border-right: 1px solid #333; 
    overflow-y: auto; 
    background: var(--panel-bg); /* Stesso sfondo del pannello laterale */
    display: flex;
    flex-direction: column;
    height: 100%;
}
.training-main { 
    flex-grow: 1; 
    padding: 20px; 
    /* background: #080808; <-- RIMOSSO per usare il colore standard */
    background: var(--panel-bg); 
    border: 1px solid #222; /* Bordo più sottile come management */
    height: 100%; 
    position: relative; 
    overflow: hidden; 
    /* Manteniamo il centraggio del gioco che è utile qui */
    display: flex; 
    align-items: center; 
    justify-content: center; 
}
/* GAME AREA */
.game-overlay {
    text-align: center;
}
.reflex-target {
    position: absolute;
    width: 60px; height: 60px;
    background: var(--accent-secondary);
    border: 2px solid #fff;
    border-radius: 50%;
    cursor: crosshair;
    box-shadow: 0 0 15px var(--accent-secondary);
    display: flex; align-items: center; justify-content: center;
    font-size: 20px; font-weight: bold; color: white;
    user-select: none;
}
.reflex-target:active { transform: scale(0.9); background: #fff; }

/* --- USER BADGE (Header Fix) --- */
.user-badge-container {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: flex-end;
}

.admin-badge {
    background: rgba(0, 255, 204, 0.1);
    border: 1px solid var(--accent-primary);
    color: var(--accent-primary);
    padding: 2px 8px;
    font-size: 0.8em;
    font-family: var(--font-mono);
    letter-spacing: 1px;
    transition: all 0.3s;
}

.user-badge-container:hover .admin-badge {
    background: var(--accent-primary);
    color: #000;
    box-shadow: 0 0 10px var(--accent-primary);
}

/* --- JOINT OPS (Training List) --- */
.training-options-grid {
    display: grid;
    grid-template-columns: 1fr; /* Lista verticale */
    gap: 10px;
    margin-top: 20px;
}

.joint-op-card {
    background: #111;
    border: 1px solid #333;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s;
}

.joint-op-card:hover {
    border-color: var(--accent-gold);
    background: #1a1a1a;
}

.joint-op-card.locked {
    opacity: 0.5;
    pointer-events: none;
    filter: grayscale(1);
    border-style: dashed;
}

/* --- ADMIN STAMINA STATES --- */
.admin-exhausted #admin-stamina-bar {
    background: #f00 !important;
    box-shadow: 0 0 10px #f00 !important;
}

.admin-exhausted .admin-badge {
    border-color: #f00;
    color: #f00;
    animation: blinker 1s infinite;
}

.joint-op-card .count-badge {
    background: #222;
    padding: 2px 6px;
    font-size: 0.7em;
    border-radius: 4px;
    color: #888;
    margin-left: 5px;
    border: 1px solid #333;
}
/* Assicurati che questo ci sia in style.css */
.unit-status-panel {
    background: #000;
    border: 1px solid #333;
    padding: 10px;
    margin-bottom: 15px;
    text-align: left;
}
.hp-bar-container {
    height: 12px;
    background: #200;
    border: 1px solid #500;
    margin-top: 5px;
    position: relative;
}

.hp-bar-fill {
    height: 100%;
    background: #0f5; /* Verde vita */
    width: 100%;
    transition: width 0.2s linear, background-color 0.3s;
}

/* Stile quando l'unità è KO (0 HP) */
.hp-bar-fill.critical {
    background: #f00 !important;
    box-shadow: 0 0 10px #f00;
}

/* Testo lampeggiante per KO */
.status-text-ko {
    color: #f00;
    font-weight: bold;
    animation: blinker 0.5s infinite;
}

/* Testo verde per Rigenerazione */
.status-text-regen {
    color: #0f5;
    font-weight: bold;
}
/* --- FIX LAYOUT TRAINING --- */
#view-training {
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
}
/* Barra Rosa per Neural Link */
.hp-bar-fill.neural {
    background: #f0f;
    box-shadow: 0 0 10px #f0f;
}
/* --- SYSTEM MODAL (Custom Alert) --- */
#sys-modal {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 9999;
    display: flex; align-items: center; justify-content: center;
    animation: fadeIn 0.2s;
}

.modal-content {
    background: #080808;
    border: 2px solid var(--accent-secondary);
    padding: 30px;
    width: 90%; max-width: 400px;
    text-align: center;
    box-shadow: 0 0 30px rgba(255, 0, 85, 0.2);
    position: relative;
}

.modal-content h2 {
    color: var(--accent-secondary);
    margin-top: 0;
    border-bottom: 1px solid #333;
    padding-bottom: 10px;
}

#modal-body {
    margin: 20px 0;
    color: #fff;
    font-family: var(--font-mono);
    line-height: 1.5;
}

.modal-content button {
    width: 100%;
    border-color: var(--accent-secondary);
    color: var(--accent-secondary);
}
.modal-content button:hover {
    background: var(--accent-secondary);
    color: #000;
}
/* styles/style.css */

/* --- SUMMON RESULT MODAL --- */
#summon-modal-overlay {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0, 0, 0, 0.9); /* Sfondo scuro quasi totale */
    z-index: 5000; /* Sopra a tutto */
    display: flex; align-items: center; justify-content: center;
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s;
}

.summon-modal-box {
    background: #080808;
    border: 2px solid var(--accent-primary);
    box-shadow: 0 0 50px rgba(0, 255, 204, 0.2);
    
    /* MODIFICA QUI: Larghezza ottimizzata per 5 carte */
    width: 95%;
    max-width: 900px; /* Abbastanza largo per 5 carte da ~150px l'una */
    
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    padding: 2px;
    position: relative;
}

.summon-header {
    background: #111;
    padding: 10px 20px;
    border-bottom: 1px solid #333;
    text-align: center;
}
.summon-header h3 {
    margin: 0; color: var(--accent-primary); letter-spacing: 2px;
}

/* AREA CONTENUTO (Scrollabile) */
#summon-result-content {
    padding: 20px;
    overflow-y: auto; /* Scroll se ci sono troppe cose */
    background: radial-gradient(circle at center, #151515 0%, #050505 100%);
    min-height: 200px;
    
    /* Centratura di default */
    display: flex; 
    justify-content: center; 
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
}

/* LAYOUT GRIGLIA PER MULTI (usato via JS) */
#summon-result-content.grid-layout {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-auto-rows: 200px; /* FORZA ogni riga ad essere alta 200px esatti */
    gap: 15px;
    justify-items: center;
}
#summon-result-content.grid-layout .summon-card {
    height: 200px;       /* Altezza fissa per tutti */
    width: 100%;         /* Occupa tutta la colonna della griglia */
    display: flex;
    flex-direction: column;
    justify-content: center; /* Centra il contenuto verticalmente */
    align-items: center;
    overflow: hidden;    /* Nasconde tutto ciò che esce dai bordi */
}

/* Pulsante Conferma in basso */
.summon-confirm-btn {
    width: 100%;
    padding: 15px;
    background: #000;
    border: none;
    border-top: 1px solid #333;
    color: #fff;
    font-size: 1.2em;
    cursor: pointer;
    transition: all 0.2s;
}
.summon-confirm-btn:hover {
    background: var(--accent-primary);
    color: #000;
    font-weight: bold;
}